import{r as l,j as t}from"./index-LyWbo2uX.js";import{s as i,A as n,i as v}from"./appwrite-BaU9ZAVh.js";import{c as $}from"./createLucideIcon-JsGswnLl.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],g=$("loader-circle",E),S=()=>{const[y,j]=l.useState([]),[d,u]=l.useState(null),[c,m]=l.useState(null),[p,x]=l.useState(null),[f,s]=l.useState(!1),[h,w]=l.useState({}),o=async()=>{s(!0);try{const a=(await i.listFiles(n)).files.map(r=>({$id:r.$id,name:r.name,previewUrl:i.getFilePreview(n,r.$id).toString()}));j(a)}catch(e){console.error("Fetch error:",e)}finally{s(!1)}},N=async()=>{if(d){s(!0);try{await i.createFile(n,v.unique(),d),u(null),o()}catch(e){console.error("Upload error:",e)}finally{s(!1)}}},b=async e=>{s(!0);try{await i.deleteFile(n,e),o()}catch(a){console.error("Delete error:",a)}finally{s(!1)}},F=async()=>{if(!(!c||!p)){s(!0);try{await i.deleteFile(n,c),await i.createFile(n,c,p),m(null),x(null),o()}catch(e){console.error("Edit error:",e)}finally{s(!1)}}};return l.useEffect(()=>{o()},[]),t.jsxs("div",{className:"p-4",children:[t.jsx("h1",{className:"text-xl font-bold mb-2",children:"Gallery"}),t.jsx("input",{type:"file",onChange:e=>{var a;return u(((a=e.target.files)==null?void 0:a[0])||null)}}),t.jsx("button",{onClick:N,className:"bg-blue-500 text-white px-4 py-2 rounded ml-2",children:"Upload"}),f?t.jsx("div",{className:"flex justify-center items-center h-48",children:t.jsx(g,{className:"h-10 w-10 animate-spin text-gray-500"})}):t.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-6",children:y.map(e=>t.jsxs("div",{className:"border p-2 rounded shadow relative",children:[!h[e.$id]&&t.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-white z-10",children:t.jsx(g,{className:"h-8 w-8 animate-spin text-gray-400"})}),t.jsx("img",{src:e.previewUrl,alt:e.name,loading:"lazy",onLoad:()=>w(a=>({...a,[e.$id]:!0})),className:`w-full h-40 object-cover transition-opacity duration-500 ${h[e.$id]?"opacity-100":"opacity-0"}`}),t.jsx("p",{className:"mt-2 text-sm truncate",children:e.name}),c===e.$id?t.jsxs(t.Fragment,{children:[t.jsx("input",{type:"file",onChange:a=>{var r;return x(((r=a.target.files)==null?void 0:r[0])||null)}}),t.jsx("button",{onClick:F,className:"bg-green-500 text-white px-2 py-1 rounded mt-1",children:"Save"})]}):t.jsxs("div",{className:"flex gap-2 mt-2",children:[t.jsx("button",{onClick:()=>m(e.$id),className:"bg-yellow-400 text-white px-2 py-1 rounded",children:"Edit"}),t.jsx("button",{onClick:()=>b(e.$id),className:"bg-red-500 text-white px-2 py-1 rounded",children:"Delete"})]})]},e.$id))})]})};export{S as default};
