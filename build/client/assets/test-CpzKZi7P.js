import{r as s,j as l}from"./index-LyWbo2uX.js";import{n as R,d as b,T as M,r as F}from"./resizeResults-DPF4xKo6.js";let j=0;const I=()=>{const a=s.useRef(null),c=s.useRef(null),[u,m]=s.useState(!1),i=s.useRef([]);return s.useEffect(()=>{(async()=>{await R.tinyFaceDetector.loadFromUri("/models"),m(!0)})()},[]),s.useEffect(()=>{(async()=>{try{const e=await navigator.mediaDevices.getUserMedia({video:!0});a.current&&(a.current.srcObject=e)}catch(e){console.error("Camera error:",e)}})()},[]),s.useEffect(()=>{if(!u||!a.current||!c.current)return;const r=a.current,e=c.current,x=setInterval(async()=>{const d={width:r.videoWidth,height:r.videoHeight};e.width=d.width,e.height=d.height;const v=await b(r,new M),p=F(v,d),f=Date.now(),w=p.map(t=>{const n=i.current.find(h=>{const y=Math.abs(h.box.x-t.box.x),g=Math.abs(h.box.y-t.box.y);return y<30&&g<30});return n?{...n,box:t.box,color:f-n.timestamp>500?"green":"red"}:{id:j++,box:t.box,timestamp:f,color:"red"}});i.current=w;const o=e.getContext("2d");o&&(o.clearRect(0,0,e.width,e.height),i.current.forEach(({box:t,color:n})=>{o.strokeStyle=n,o.lineWidth=2,o.strokeRect(t.x,t.y,t.width,t.height)}))},100);return()=>clearInterval(x)},[u]),l.jsxs("div",{className:"relative w-full max-w-xl mx-auto",children:[l.jsx("video",{ref:a,autoPlay:!0,muted:!0,playsInline:!0,className:"rounded-md w-full h-auto",onLoadedMetadata:()=>{var r;return(r=a.current)==null?void 0:r.play()}}),l.jsx("canvas",{ref:c,className:"absolute top-0 left-0 w-full h-full pointer-events-none"})]})};export{I as default};
